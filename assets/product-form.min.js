const cart=document.querySelector(".js-minicart");function padWithLeadingZeros(t,e){return String(t).padStart(e,"0")}function addToCart(t){t=this;let e=this.dataset.id,n={id:e,quantity:1},a=document.querySelector('input[name="selling_plan"]');a&&(n={id:e,quantity:1,selling_plan:a.value});const s=document.querySelectorAll(".js-cart-count");t.classList.add("loading"),console.log(t),$.ajax({type:"POST",url:"/cart/add.js",data:n,dataType:"json",success:function(){t.classList.contains("js-cross-sell")&&document.querySelector(".js-minicart-cross-sell").remove(),$.getJSON("/cart.js",(function(t){s.forEach((e=>{e.textContent=padWithLeadingZeros(t.item_count,2),0==t.itemCount?e.classList.add("hidden"):e.classList.remove("hidden")}))})),t.classList.remove("loading"),updateCart(),openCart()},error:function(t){console.log("error: ",t)}})}function addMembership(t,e){e=this,t.preventDefault();let n=document.querySelector(".js-membership-flavor"),a=document.querySelector(".js-selling-plan"),s=document.querySelector(".js-membership-quantity"),o=n.options[n.selectedIndex].dataset.id,i=a.options[a.selectedIndex].value,l=s.options[s.selectedIndex].value;console.log(o),console.log(i),console.log(l);let c={id:o,quantity:l,selling_plan:i};e.classList.add("loading"),$.ajax({type:"POST",url:"/cart/add.js",data:c,dataType:"json",success:function(){$.getJSON("/cart.js",(function(t){cartCount.textContent=t.item_count})),e.classList.remove("loading"),updateCart(),openCart()},error:function(t){console.log("error: ",t)}})}function updateCart(){let t=[];const e=document.querySelector(".js-minicart-items"),n=(document.querySelector(".js-minicart-total"),document.querySelectorAll(".js-cart-count"));$.ajax({type:"GET",url:"/cart?view=data.json",success:function(a){json_response=JSON.parse(a),Array.prototype.forEach.call(json_response.items,(function(e,n){console.log(e);let a=e.id,s=e.url,o=e.image,i=e.alt,l=e.title,c=e.quantity,r=e.price,d=(e.subtotal,e.options);options_html="",d.forEach((t=>{"Default Title"!==t.value&&(options_html+="<span class='minicart__item-option h5'>"+t.value+"</span>")})),console.log(d);let u=`\n                <div class="minicart__item js-item" data-id="${a}">\n                    <a class="minicart__item-image" href="${s}">\n                        <img width="300" height="300" loading="lazy" src="${o}"\n                            alt="${i}" />\n                    </a>\n                    <div class="minicart__item-details">\n                        <a class="minicart__item-title" href="${s}">${l}</a>\n                        <span class="minicart__item-price">${r}</span>\n                        <span class="minicart__item-options">\n                            ${options_html}\n                        </span>\n                        <div class="minicart__item-qty">\n                            <button class="js-update-qty less">-</button>\n                            <input class="js-minicart-qty" type="number" data-id="${a}" value="${c}" min="1"   />\n                            <button class="js-update-qty more">+</button>\n                        </div>\n                        <div class="minicart__item-remove h5 js-remove-item" data-id="${a}">Remove</div>\n                    </div>\n                </div>\n              `;t.push(u)})),e.innerHTML=t.join(""),console.log("data count"),console.log(json_response.count),n.forEach((t=>{t.textContent=padWithLeadingZeros(json_response.count,2),0==json_response.count?t.classList.add("hidden"):t.classList.remove("hidden")}))},error:function(t){console.warn("ERROR",t)}})}for(var add_to_cart=document.querySelectorAll(".js-add-to-cart"),i=0;i<add_to_cart.length;i++){(current=add_to_cart[i]).addEventListener("click",addToCart,!1)}var add_membership=document.querySelectorAll(".js-add-membership");for(i=0;i<add_membership.length;i++){var current;(current=add_membership[i]).addEventListener("click",addMembership,!1)}function openCart(t){cart.classList.add("active"),document.body.classList.add("menu-open")}function toggleCart(t){cart.classList.toggle("active"),document.body.classList.toggle("menu-open")}var toggle=document.querySelectorAll(".js-toggle-cart");for(i=0;i<toggle.length;i++)toggle[i].addEventListener("click",toggleCart,!1);function updateQuantity(t){if(t.classList.contains("less")){let e=t.nextElementSibling;e.value--;let n=e.value,a=e.dataset.id;$.post("/cart/change.js",{quantity:n,id:a},null,"json").done((function(){updateCart()}))}else if(t.classList.contains("more")){let e=t.previousElementSibling;e.value++;let n=e.value,a=e.dataset.id;console.log(a),$.post("/cart/change.js",{quantity:n,id:a},null,"json").done((function(){console.log("test?"),updateCart()}))}}function removeItem(t){console.log(t);let e=t.dataset.id;$.post("/cart/change.js",{quantity:0,id:e},null,"json").done((function(){updateCart()}))}function hasClass(t,e){return console.log(t),t.className.split(" ").indexOf(e)>-1}document.addEventListener("click",(function(t){hasClass(t.target,"js-remove-item")?removeItem(t.target):hasClass(t.target,"js-update-qty")&&updateQuantity(t.target)}),!1);