function liveQuery(t,e,n,a){(a||document).addEventListener(e,(function(e){for(var a=document.querySelectorAll(t),i=[],o=0;o<a.length;++o)i.push(a[o]);if(i){for(var s=e.target,r=-1;s&&(r=-1===i.indexOf(s));)s=s.parentElement;r>-1&&n.call(s,e)}}),!1)}const cart=document.querySelector(".js-minicart");function addToCart(t){t=this;let e=this.dataset.id;const n=document.querySelector(".js-cart-count");t.classList.add("loading"),$.ajax({type:"POST",url:"/cart/add.js",data:{id:e,quantity:1},dataType:"json",success:function(){$.getJSON("/cart.js",(function(t){n.textContent=t.item_count})),t.classList.remove("loading"),updateCart(),openCart()},error:function(t){console.log("error: ",t)}})}function updateCart(){let t=[];const e=document.querySelector(".js-minicart-items"),n=document.querySelector(".js-minicart-total"),a=document.querySelectorAll(".js-cart-count");$.ajax({type:"GET",url:"/cart?view=data.json",success:function(i){json_response=JSON.parse(i),console.log("response",json_response);let o=json_response.subtotal;Array.prototype.forEach.call(json_response.items,(function(e,n){console.log(e);let a,i=e.id,o=e.url,s=e.image,r=e.alt,l=e.title,c=e.color.substring(1,e.color.length-1),d=e.quantity;c||(a="gradient");let u=`\n                <div class="minicart__item js-item" data-id="${i}">\n                    <a class="minicart__item-image ${a}"\n                        href="${o}" style="--bg: ${c}">\n                        <img width="300" height="300" loading="lazy" src="${s}"\n                            alt="${r}" />\n                    </a>\n                    <div class="minicart__item-details">\n                        <a class="minicart__item-title" href="${o}">${l}</a>\n                        <span class="minicart__item-flavor">${e.flavor} <br />12 Bars</span>\n                        <span class="minicart__item-price">${e.price}</span>\n                        <div class="minicart__item-qty">\n                            <button class="js-update-qty less">-</button>\n                            <input class="js-minicart-qty" type="number" value="${d}" min="1" data-id="${i}" />\n                            <button class="js-update-qty more">+</button>\n                        </div>\n                        <div class="minicart__item-remove js-remove-item" data-id="${i}">\n                          <svg xmlns="http://www.w3.org/2000/svg" width="16.263" height="16.263" viewBox="0 0 16.263 16.263">\n                            <g id="Close" transform="translate(0.354 0.354)">\n                              <line id="Line_23" data-name="Line 23" x2="22" transform="rotate(45)" fill="none" stroke="#1c1c1c" stroke-width="1"></line>\n                              <line id="Line_25" data-name="Line 25" x2="22" transform="translate(15.556) rotate(135)" fill="none" stroke="#1c1c1c" stroke-width="1"></line>\n                            </g>\n                          </svg>\n                      </div>\n                    </div>\n                </div>\n              `;t.push(u)})),console.log(t.join("").toString()),e.innerHTML=t.join(""),n.innerText=o,a.innerText=json_response.count},error:function(t){console.warn("ERROR",t)}})}for(var atc=document.querySelectorAll(".js-add-to-cart"),i=0;i<atc.length;i++){var current=atc[i];current.addEventListener("click",addToCart,!1)}function openCart(t){cart.classList.add("active")}function toggleCart(t){cart.classList.toggle("active")}var toggle=document.querySelectorAll(".js-toggle-cart");for(i=0;i<toggle.length;i++)toggle[i].addEventListener("click",toggleCart,!1);var flavor=document.querySelectorAll(".js-flavor");for(i=0;i<flavor.length;i++)flavor[i].addEventListener("change",(function(t,e){console.log("changed"),console.log(t),e=t.target.options.selectedIndex;let n=t.target.options[e].dataset.url;document.location.pathname=n}),!1);function updateQuantity(t){if(t.classList.contains("less")){let e=t.nextElementSibling;e.value--;let n=e.value,a=e.dataset.id;$.post("/cart/change.js",{quantity:n,id:a},null,"json").done((function(){updateCart()}))}else if(t.classList.contains("more")){let e=t.previousElementSibling;e.value++;let n=e.value,a=e.dataset.id;$.post("/cart/change.js",{quantity:n,id:a},null,"json").done((function(){updateCart()}))}}function removeItem(t){console.log(t);let e=t.dataset.id;$.post("/cart/change.js",{quantity:0,id:e},null,"json").done((function(){updateCart()}))}function hasClass(t,e){return t.className.split(" ").indexOf(e)>-1}document.addEventListener("click",(function(t){hasClass(t.target,"js-remove-item")?removeItem(t.target):hasClass(t.target,"js-update-qty")&&updateQuantity(t.target)}),!1);